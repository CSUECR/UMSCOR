@model RoleVModel
@{
    ViewBag.Title = "角色配置";
    Layout = "~/Views/Shared/_SysLayout.cshtml";
    string rs = ViewBag.RS;
    var backurl = ViewBag.ReturnUrl ?? "/Role/Index";       
    var roleList = new RoleVModel().List.ToList();    
    var RPVList = new BaseBll<wmfRolePrivilegesView>().All.Where(p => p.RoleId == Model.RoleId);
}
@Styles.Render("~/Content/themes/base/css")
@Scripts.Render("~/bundles/jqueryui")
<section class="featuredwhite">   
    <div class="content-wrapper clear-fix">        
        @if (rs.HP(操作.配置))
{
    <button class="btn green" type="button" onclick="jumptourl('/Role/Add?returnUrl=@(Url.Encode(Request.RawUrl))')">@("提交".GX())</button>
}        
        <button class="btn purple" type="button" onclick="morsunEC('#MoreSunTreeTable', 'expandAll')">@("展开".GX())</button>
        <button class="btn purple" type="button" onclick="morsunEC('#MoreSunTreeTable', 'collapseAll')">@("收起".GX())</button>
        <div class="portlet box @("red".getBC("BootStrapCssTable"))">
            <div class="portlet-title">
                <div class="caption"><i class="icon-cogs"></i>角色配置</div>                
            </div>
            <div class="portlet-body">                
                <table id="MoreSunTreeTable" class="table table-hover">
                    <thead>
                        <tr>
                            <th>资源</th>
                            <th style="text-align:left">操作</th>                            
                        </tr>
                    </thead>                    
                    <tbody>
                        @{Action<wmfResource> action = (i) =>
                          {
                              Func<wmfResource, HelperResult>
                                fun = @<tr id="TR_@item.ID" data-tt-id="@item.ID" data-tt-parent-id="@item.ParentId">
                                    <td style="text-align:left;">
                                        <span class="folder ui-draggable">
                                            <input id="CK_@item.ID" type="checkbox" class="m-wrap" onclick="checkContainer('#CK_@item.ID','PrivId','#TD_@item.ID')" /> @item.ResourceCNName</span>
                                    </td>
                                    <td id="TD_@item.ID" style="text-align:left">
                                        @{var sp = Model.Privileges.Where(p => p.ResourceId == item.ID).OrderBy(p => p.wmfOperation.Sort);}
                                        @foreach (var p in sp)
                                        {
                                            <input type="checkbox" class="m-wrap" name="PrivId" value="@p.ID" /> @p.wmfOperation.OperationCNName
                                        }
                                    </td>                                    
                                </tr>;
                              Write(fun(i));
                          };
                          Model.Each(new ResourceVModel().Roots, action);
                        }
                    </tbody>  
                </table>
@using (Html.BeginForm("Create", "Role", new { ReturnUrl = ViewBag.ReturnUrl }, FormMethod.Post, new { id = "fmForm", @class = "styleThese" }))
{
    <table width="100%">
				<tr>
					<td width="50%">
						<div>
							<label>Message:</label>
							<textarea cols="40" rows="5"></textarea>
						</div>
						<div>
							<label>Unstyled:</label>
							<input class="skipThese" type="text" size="40" value="This is unstyled on purpose" />
						</div>
						<div>
							<label>Your Name:</label>
							<input type="text" size="40" value="John Doe"/>
						</div>
						<div>
							<label>Your Email:</label>
							<input type="email" size="40" value="mr_hotshot0357@example.com" />
						</div>
						<div>
							<label>Search:</label>
							<input type="search" size="40"/>
						</div>
						<div>
							<label>Phone:</label>
							<input type="tel" size="40"/>
						</div>
						<div>
							<label>URL:</label>
							<input type="url" size="40"/>
						</div>
						<div>
							<label>Datetime:</label>
							<input type="datetime" size="40"/>
						</div>
						<div>
							<label>Date:</label>
							<input type="date" size="40"/>
						</div>
						<div>
							<label>Month:</label>
							<input type="month" size="40"/>
						</div>
						<div>
							<label>Week:</label>
							<input type="week" size="40"/>
						</div>
						<div>
							<label>Time:</label>
							<input type="time" size="40"/>
						</div>
						<div>
							<label>Datetime-local:</label>
							<input type="datetime-local" size="40"/>
						</div>
					</td>
					<td>
						<div>
							<label>Number:</label>
							<input type="number" size="40"/>
						</div>
						<div>
							<label>Range:</label>
							<input type="range" size="40"/>
						</div>
						<div>
							<label>Color:</label>
							<input type="color" size="40"/>
						</div>
						<div>
							<label>Some Password:</label>
							<input type="password" size="40"/>
						</div>
						<div>
							<label>I found your site:</label>
							<select id="demoFoundSite">
								<option value="google">Through Google</option>
								<option value="twitter">Through Twitter</option>
								<option value="other">Other&hellip;</option>
								<option value="hi">&lt;Hi&gt;</option>
							</select>
						</div>
						<div>
							<label>How do you feel?</label>
							<select id="demoFeeling" multiple="multiple" size=4>
								<option value="elated">Elated</option>
								<option value="happy">Happy</option>
								<option value="content">Content</option>
								<option value="ok">Ok</option>
								<option value="unhappy">Unhappy</option>
								<option value="frustrated">Frustrated</option>
								<option value="cranky">Cranky</option>
								<option value="mad">Mad</option>
								<option value="unlisted">Anything else</option>
							</select>
						</div>
						<div>
							<label>
								<input type="radio" name="radio" value="hi" /> Saying hi
							</label>
							<label>
								<input type="radio" name="radio" value="feedback" /> Sending feedback
							</label>
							<label>
								<input type="radio" name="radio" value="default" checked="CHECKED" /> Default Seleted Radio
							</label>
						</div>
						<div>
							<label>
								<input type="checkbox" id="contactBack" /> Please contact me back
							</label>
							<label>
								<input type="checkbox" checked="CHECKED" id="goodDay" /> Today is a good day
							</label>
						</div>
						<div>
							<label>Upload a file:</label>
							<input type="file" />
						</div>
					</td>
				</tr>
			</table>
}
            </div>
        </div>
    </div>   
  
</section>
    @section Scripts {        
        @Scripts.Render("~/bundles/jqueryval")        
        @Scripts.Render("~/bundles/validator")
        @Styles.Render("~/Content/JQueryQtipCss")
        @Scripts.Render("~/bundles/jqueryqtip")       
        @Scripts.Render("~/bundles/morsuncommon")
        @Styles.Render("~/Content/treetableCss")
        @Scripts.Render("~/bundles/treetable")  
        <script type="text/javascript">              
            morsunTreeTable('#MoreSunTreeTable', "expanded", false);

            $(function () {
                var $min, $remove, $apply, $uniformed;

                // Debugging code to check for multiple click events
                $selects = $("select").click(function () {
                    if (typeof console !== 'undefined' && typeof console.log !== 'undefined') {
                        console.log($(this).attr('id') + " clicked");
                    }
                });

                $uniformed = $(".styleThese").find("input, textarea, select, button, a.uniformTest").not(".skipThese");
                $uniformed.uniform();

                $("#optionsForm input, #optionsForm select").change(function () {
                    this.form.submit();
                });

                if (optionValues.min) {
                    $min = $("#optionsMin");

                    if ($min.prop) {
                        $min.prop("checked", true);
                    } else {
                        $min.attr("checked", "checked");
                    }
                }

                $("#optionsJquery").val(optionValues.jquery);
                $("#optionsTheme").val(optionValues.theme);
                $("#jqueryCurrentVersion").text("Using " + jQuery.fn.jquery);
                $remove = $("#remove");
                $apply = $("#apply");
                $remove.click(function () {
                    $uniformed.uniform.restore();
                    $remove.hide();
                    $apply.show();
                    return false;
                });
                $apply.click(function () {
                    $uniformed.uniform();
                    $apply.hide();
                    $remove.show();
                    return false;
                });
            });
        </script>
    }
